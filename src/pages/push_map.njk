{% set page_title = "推案地圖" %}
{% set body_class = "push-map-body " %}
{% set locationData = [
    {
        "title": "幸福公園1",
        "lat": 24.910884008482792,
        "lng": 121.20878008767802,
        "floor_space": "18坪-83坪",
        "loc_img": "assets/images/push_map/1.webp",
        "loc_url": "https://maps.app.goo.gl/G8EAjbhg6rzzkeSq9"
    },
    {
        "title": "幸福公園2",
        "lat": 25.022532791469267,
        "lng": 121.31231321003989,
        "floor_space": "12坪-52坪",
        "loc_img": "assets/images/push_map/2.webp",
        "loc_url": "https://maps.app.goo.gl/G8EAjbhg6rzzkeSq9"
    },
    {
        "title": "幸福公園3",
        "lat": 25.022189305236147,
        "lng": 121.31204515954106,
        "floor_space": "23坪-135坪",
        "loc_img": "assets/images/push_map/3.webp",
        "loc_url": "https://maps.app.goo.gl/G8EAjbhg6rzzkeSq9"
    },
    {
        "title": "幸福公園5",
        "lat": 24.88252891553665,
        "lng": 121.2085474024835,
        "floor_space": "28坪-38坪",
        "loc_img": "assets/images/push_map/5.webp",
        "loc_url": "https://maps.app.goo.gl/G8EAjbhg6rzzkeSq9"
    },
    {
        "title": "幸福公園6",
        "lat": 24.961719286605344,
        "lng": 121.16768037363587,
        "floor_space": "27坪-31坪",
        "loc_img": "assets/images/push_map/6.webp",
        "loc_url": "https://maps.app.goo.gl/G8EAjbhg6rzzkeSq9"
    },
    {
        "title": "幸福公園7",
        "lat": 24.910931639097335,
        "lng": 121.2734814968071,
        "floor_space": "27坪-31坪",
        "loc_img": "assets/images/push_map/1.webp",
        "loc_url": "https://maps.app.goo.gl/G8EAjbhg6rzzkeSq9"
    }
] %}
{% macro locationItem(title, lat, lng, floor_space, loc_img, loc_url) %}
    <div class="item"
         data-title="[[ title ]]"
         data-lat="[[ lat ]]"
         data-lng="[[ lng ]]"
         data-floor-space="[[ floor_space ]]"
         data-loc-img="[[ loc_img ]]"
         data-url="[[ loc_url ]]">
        <div class="img-box">
            <img src="[[ loc_img ]]" alt="" srcset="" />
        </div>
        <div class="info">
            <div class="name">[[ title ]]</div>
            <div class="content">坪數規劃:[[ floor_space ]]</div>
        </div>
    </div>
{% endmacro %}
{% extends "layout.njk" %}
{% block head_script %}
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA7YTKkfqHMWYicRb2Ig0kgJDLSam7uUzo&libraries=marker&loading=async"></script>
    <script>
        // 等待 Google Maps API 載入完成
        window.initGoogleMap = new Promise((resolve) => {
            const checkGoogle = () => {
                if (window.google && window.google.maps && window.google.maps.importLibrary) {
                    resolve();
                } else if (window.google && window.google.maps && window.google.maps.Map) {
                    // 如果 importLibrary 不存在，但 Map 存在，也可以使用（傳統方式）
                    resolve();
                } else {
                    setTimeout(checkGoogle, 100);
                }
            };
            checkGoogle();
        });
    </script>
{% endblock %}
{% block content %}
    <main class="main-box page-push-map">
        <section class="banner-box page-banner">
            <div class="img-box">
                <picture>
                    <source srcset="assets/images/push_map/banner-m.jpg" media="(max-width: 1024px)" />
                    <img src="assets/images/push_map/banner.jpg" alt="" />
                </picture>
            </div>
        </section>
        <section class="push-map-wrap">
            <div class="title-box page-title">
                <div class="top">
                    <div class="line"></div>
                    <div class="zh">推案地圖</div>
                    <div class="line"></div>
                </div>
                <div class="bottom">
                    <div class="en">PROJECT MAP</div>
                </div>
            </div>
            <div class="push-map-box">
                <div id="map" class="google-iframe-box"></div>
                <div class="item-list">
                    {% for item in locationData %}
                        [[ locationItem(item.title, item.lat, item.lng, item.floor_space, item.loc_img, item.loc_url) ]]
                    {% endfor %}
                </div>
            </div>
        </section>
    </main>
{% endblock %}
{% block page_script %}
    <script src="js/main.js{% if VERSION != '' %}?v=[[VERSION]]{% endif %}"></script>
    <script src="js/push_map.js{% if VERSION != '' %}?v=[[VERSION]]{% endif %}"></script>
{% endblock %}
